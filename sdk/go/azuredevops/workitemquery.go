// Code generated by pulumi-language-go DO NOT EDIT.
// *** WARNING: Do not edit by hand unless you're certain you know what you are doing! ***

package azuredevops

import (
	"context"
	"reflect"

	"errors"
	"github.com/pulumi/pulumi-azuredevops/sdk/v3/go/azuredevops/internal"
	"github.com/pulumi/pulumi/sdk/v3/go/pulumi"
)

// Manages a Work Item Query (WIQL based list / tree query) in Azure DevOps.
//
// A query can live either directly under one of the root areas `Shared Queries` or `My Queries`, or inside another query folder. You must provide exactly one of `area` (either `Shared Queries` or `My Queries`) or `parentId` (an existing folder's ID) when creating a query.
//
// The WIQL (Work Item Query Language) statement is used to define the query logic. See the [WIQL Syntax Reference](https://learn.microsoft.com/en-us/azure/devops/boards/queries/wiql-syntax?view=azure-devops) for more information.
//
// ## Example Usage
//
// ### Basic query under Shared Queries
//
// ```go
// package main
//
// import (
//
//	"github.com/pulumi/pulumi-azuredevops/sdk/v3/go/azuredevops"
//	"github.com/pulumi/pulumi/sdk/v3/go/pulumi"
//
// )
//
//	func main() {
//		pulumi.Run(func(ctx *pulumi.Context) error {
//			example, err := azuredevops.NewProject(ctx, "example", &azuredevops.ProjectArgs{
//				Name:             pulumi.String("Example Project"),
//				WorkItemTemplate: pulumi.String("Agile"),
//				VersionControl:   pulumi.String("Git"),
//				Visibility:       pulumi.String("private"),
//			})
//			if err != nil {
//				return err
//			}
//			_, err = azuredevops.NewWorkitemquery(ctx, "all_issues", &azuredevops.WorkitemqueryArgs{
//				ProjectId: example.ID(),
//				Name:      pulumi.String("All Active Issues"),
//				Area:      pulumi.String("Shared Queries"),
//				Wiql: pulumi.String(`SELECT [System.Id], [System.Title], [System.State]
//
// FROM WorkItems
// WHERE [System.WorkItemType] = 'Issue'
//
//	AND [System.State] <> 'Closed'
//
// ORDER BY [System.ChangedDate] DESC
// `),
//
//			})
//			if err != nil {
//				return err
//			}
//			return nil
//		})
//	}
//
// ```
//
// ### Query inside a custom folder
//
// ```go
// package main
//
// import (
//
//	"github.com/pulumi/pulumi-azuredevops/sdk/v3/go/azuredevops"
//	"github.com/pulumi/pulumi/sdk/v3/go/pulumi"
//
// )
//
//	func main() {
//		pulumi.Run(func(ctx *pulumi.Context) error {
//			example, err := azuredevops.NewProject(ctx, "example", &azuredevops.ProjectArgs{
//				Name:             pulumi.String("Example Project"),
//				WorkItemTemplate: pulumi.String("Agile"),
//				VersionControl:   pulumi.String("Git"),
//				Visibility:       pulumi.String("private"),
//			})
//			if err != nil {
//				return err
//			}
//			teamFolder, err := azuredevops.NewWorkitemqueryFolder(ctx, "team_folder", &azuredevops.WorkitemqueryFolderArgs{
//				ProjectId: example.ID(),
//				Name:      pulumi.String("Team"),
//				Area:      pulumi.String("Shared Queries"),
//			})
//			if err != nil {
//				return err
//			}
//			_, err = azuredevops.NewWorkitemquery(ctx, "my_team_bugs", &azuredevops.WorkitemqueryArgs{
//				ProjectId: example.ID(),
//				Name:      pulumi.String("Team Bugs"),
//				ParentId:  teamFolder.ID(),
//				Wiql: pulumi.String(`SELECT [System.Id], [System.Title], [System.State], [System.AssignedTo]
//
// FROM WorkItems
// WHERE [System.WorkItemType] = 'Bug'
//
//	AND [System.State] <> 'Closed'
//
// ORDER BY [System.CreatedDate] DESC
// `),
//
//			})
//			if err != nil {
//				return err
//			}
//			return nil
//		})
//	}
//
// ```
//
// ### Applying permissions to a query
//
// ```go
// package main
//
// import (
//
//	"github.com/pulumi/pulumi-azuredevops/sdk/v3/go/azuredevops"
//	"github.com/pulumi/pulumi-std/sdk/go/std"
//	"github.com/pulumi/pulumi/sdk/v3/go/pulumi"
//
// )
//
//	func main() {
//		pulumi.Run(func(ctx *pulumi.Context) error {
//			example, err := azuredevops.NewProject(ctx, "example", &azuredevops.ProjectArgs{
//				Name:             pulumi.String("Example Project"),
//				WorkItemTemplate: pulumi.String("Agile"),
//				VersionControl:   pulumi.String("Git"),
//				Visibility:       pulumi.String("private"),
//			})
//			if err != nil {
//				return err
//			}
//			teamFolder, err := azuredevops.NewWorkitemqueryFolder(ctx, "team_folder", &azuredevops.WorkitemqueryFolderArgs{
//				ProjectId: example.ID(),
//				Name:      pulumi.String("Team"),
//				Area:      pulumi.String("Shared Queries"),
//			})
//			if err != nil {
//				return err
//			}
//			myTeamBugs, err := azuredevops.NewWorkitemquery(ctx, "my_team_bugs", &azuredevops.WorkitemqueryArgs{
//				ProjectId: example.ID(),
//				Name:      pulumi.String("Team Bugs"),
//				ParentId:  teamFolder.ID(),
//				Wiql: pulumi.String(`SELECT [System.Id], [System.Title], [System.State], [System.AssignedTo]
//
// FROM WorkItems
// WHERE [System.WorkItemType] = 'Bug'
//
//	AND [System.State] <> 'Closed'
//
// ORDER BY [System.CreatedDate] DESC
// `),
//
//			})
//			if err != nil {
//				return err
//			}
//			example_readers := azuredevops.LookupGroupOutput(ctx, azuredevops.GetGroupOutputArgs{
//				ProjectId: example.ID(),
//				Name:      pulumi.String("Readers"),
//			}, nil)
//			invokeFormat, err := std.Format(ctx, map[string]interface{}{
//				"input": "%s/%s",
//				"args": pulumi.StringArray{
//					teamFolder.Name,
//					myTeamBugs.Name,
//				},
//			}, nil)
//			if err != nil {
//				return err
//			}
//			_, err = azuredevops.NewWorkItemQueryPermissions(ctx, "query_permissions", &azuredevops.WorkItemQueryPermissionsArgs{
//				ProjectId: example.ID(),
//				Path:      invokeFormat.Result,
//				Principal: pulumi.String(example_readers.ApplyT(func(example_readers azuredevops.GetGroupResult) (*string, error) {
//					return &example_readers.Id, nil
//				}).(pulumi.StringPtrOutput)),
//				Permissions: pulumi.StringMap{
//					"Read":              pulumi.String("Allow"),
//					"Contribute":        pulumi.String("Deny"),
//					"ManagePermissions": pulumi.String("Deny"),
//					"Delete":            pulumi.String("Deny"),
//				},
//			})
//			if err != nil {
//				return err
//			}
//			return nil
//		})
//	}
//
// ```
//
// ## Relevant Links
//
// * [Azure DevOps REST API - Work Item Query (Queries)](https://learn.microsoft.com/en-us/rest/api/azure/devops/wit/queries?view=azure-devops-rest-7.1)
// * [WIQL Syntax Reference](https://learn.microsoft.com/en-us/azure/devops/boards/queries/wiql-syntax?view=azure-devops)
//
// ## PAT Permissions Required
//
// * **Work Items**: Read & Write
//
// ## Import
//
// The resource does not support import.
type Workitemquery struct {
	pulumi.CustomResourceState

	// Root folder for the query. Must be one of `Shared Queries` or `My Queries`.
	Area pulumi.StringPtrOutput `pulumi:"area"`
	// The display name of the query.
	Name pulumi.StringOutput `pulumi:"name"`
	// The ID of the parent query folder under which to create the query.
	ParentId pulumi.StringPtrOutput `pulumi:"parentId"`
	// The ID of the Project containing the query.
	ProjectId pulumi.StringOutput `pulumi:"projectId"`
	// The WIQL (Work Item Query Language) statement. Length 1–32000 characters.
	Wiql pulumi.StringOutput `pulumi:"wiql"`
}

// NewWorkitemquery registers a new resource with the given unique name, arguments, and options.
func NewWorkitemquery(ctx *pulumi.Context,
	name string, args *WorkitemqueryArgs, opts ...pulumi.ResourceOption) (*Workitemquery, error) {
	if args == nil {
		return nil, errors.New("missing one or more required arguments")
	}

	if args.ProjectId == nil {
		return nil, errors.New("invalid value for required argument 'ProjectId'")
	}
	if args.Wiql == nil {
		return nil, errors.New("invalid value for required argument 'Wiql'")
	}
	opts = internal.PkgResourceDefaultOpts(opts)
	var resource Workitemquery
	err := ctx.RegisterResource("azuredevops:index/workitemquery:Workitemquery", name, args, &resource, opts...)
	if err != nil {
		return nil, err
	}
	return &resource, nil
}

// GetWorkitemquery gets an existing Workitemquery resource's state with the given name, ID, and optional
// state properties that are used to uniquely qualify the lookup (nil if not required).
func GetWorkitemquery(ctx *pulumi.Context,
	name string, id pulumi.IDInput, state *WorkitemqueryState, opts ...pulumi.ResourceOption) (*Workitemquery, error) {
	var resource Workitemquery
	err := ctx.ReadResource("azuredevops:index/workitemquery:Workitemquery", name, id, state, &resource, opts...)
	if err != nil {
		return nil, err
	}
	return &resource, nil
}

// Input properties used for looking up and filtering Workitemquery resources.
type workitemqueryState struct {
	// Root folder for the query. Must be one of `Shared Queries` or `My Queries`.
	Area *string `pulumi:"area"`
	// The display name of the query.
	Name *string `pulumi:"name"`
	// The ID of the parent query folder under which to create the query.
	ParentId *string `pulumi:"parentId"`
	// The ID of the Project containing the query.
	ProjectId *string `pulumi:"projectId"`
	// The WIQL (Work Item Query Language) statement. Length 1–32000 characters.
	Wiql *string `pulumi:"wiql"`
}

type WorkitemqueryState struct {
	// Root folder for the query. Must be one of `Shared Queries` or `My Queries`.
	Area pulumi.StringPtrInput
	// The display name of the query.
	Name pulumi.StringPtrInput
	// The ID of the parent query folder under which to create the query.
	ParentId pulumi.StringPtrInput
	// The ID of the Project containing the query.
	ProjectId pulumi.StringPtrInput
	// The WIQL (Work Item Query Language) statement. Length 1–32000 characters.
	Wiql pulumi.StringPtrInput
}

func (WorkitemqueryState) ElementType() reflect.Type {
	return reflect.TypeOf((*workitemqueryState)(nil)).Elem()
}

type workitemqueryArgs struct {
	// Root folder for the query. Must be one of `Shared Queries` or `My Queries`.
	Area *string `pulumi:"area"`
	// The display name of the query.
	Name *string `pulumi:"name"`
	// The ID of the parent query folder under which to create the query.
	ParentId *string `pulumi:"parentId"`
	// The ID of the Project containing the query.
	ProjectId string `pulumi:"projectId"`
	// The WIQL (Work Item Query Language) statement. Length 1–32000 characters.
	Wiql string `pulumi:"wiql"`
}

// The set of arguments for constructing a Workitemquery resource.
type WorkitemqueryArgs struct {
	// Root folder for the query. Must be one of `Shared Queries` or `My Queries`.
	Area pulumi.StringPtrInput
	// The display name of the query.
	Name pulumi.StringPtrInput
	// The ID of the parent query folder under which to create the query.
	ParentId pulumi.StringPtrInput
	// The ID of the Project containing the query.
	ProjectId pulumi.StringInput
	// The WIQL (Work Item Query Language) statement. Length 1–32000 characters.
	Wiql pulumi.StringInput
}

func (WorkitemqueryArgs) ElementType() reflect.Type {
	return reflect.TypeOf((*workitemqueryArgs)(nil)).Elem()
}

type WorkitemqueryInput interface {
	pulumi.Input

	ToWorkitemqueryOutput() WorkitemqueryOutput
	ToWorkitemqueryOutputWithContext(ctx context.Context) WorkitemqueryOutput
}

func (*Workitemquery) ElementType() reflect.Type {
	return reflect.TypeOf((**Workitemquery)(nil)).Elem()
}

func (i *Workitemquery) ToWorkitemqueryOutput() WorkitemqueryOutput {
	return i.ToWorkitemqueryOutputWithContext(context.Background())
}

func (i *Workitemquery) ToWorkitemqueryOutputWithContext(ctx context.Context) WorkitemqueryOutput {
	return pulumi.ToOutputWithContext(ctx, i).(WorkitemqueryOutput)
}

// WorkitemqueryArrayInput is an input type that accepts WorkitemqueryArray and WorkitemqueryArrayOutput values.
// You can construct a concrete instance of `WorkitemqueryArrayInput` via:
//
//	WorkitemqueryArray{ WorkitemqueryArgs{...} }
type WorkitemqueryArrayInput interface {
	pulumi.Input

	ToWorkitemqueryArrayOutput() WorkitemqueryArrayOutput
	ToWorkitemqueryArrayOutputWithContext(context.Context) WorkitemqueryArrayOutput
}

type WorkitemqueryArray []WorkitemqueryInput

func (WorkitemqueryArray) ElementType() reflect.Type {
	return reflect.TypeOf((*[]*Workitemquery)(nil)).Elem()
}

func (i WorkitemqueryArray) ToWorkitemqueryArrayOutput() WorkitemqueryArrayOutput {
	return i.ToWorkitemqueryArrayOutputWithContext(context.Background())
}

func (i WorkitemqueryArray) ToWorkitemqueryArrayOutputWithContext(ctx context.Context) WorkitemqueryArrayOutput {
	return pulumi.ToOutputWithContext(ctx, i).(WorkitemqueryArrayOutput)
}

// WorkitemqueryMapInput is an input type that accepts WorkitemqueryMap and WorkitemqueryMapOutput values.
// You can construct a concrete instance of `WorkitemqueryMapInput` via:
//
//	WorkitemqueryMap{ "key": WorkitemqueryArgs{...} }
type WorkitemqueryMapInput interface {
	pulumi.Input

	ToWorkitemqueryMapOutput() WorkitemqueryMapOutput
	ToWorkitemqueryMapOutputWithContext(context.Context) WorkitemqueryMapOutput
}

type WorkitemqueryMap map[string]WorkitemqueryInput

func (WorkitemqueryMap) ElementType() reflect.Type {
	return reflect.TypeOf((*map[string]*Workitemquery)(nil)).Elem()
}

func (i WorkitemqueryMap) ToWorkitemqueryMapOutput() WorkitemqueryMapOutput {
	return i.ToWorkitemqueryMapOutputWithContext(context.Background())
}

func (i WorkitemqueryMap) ToWorkitemqueryMapOutputWithContext(ctx context.Context) WorkitemqueryMapOutput {
	return pulumi.ToOutputWithContext(ctx, i).(WorkitemqueryMapOutput)
}

type WorkitemqueryOutput struct{ *pulumi.OutputState }

func (WorkitemqueryOutput) ElementType() reflect.Type {
	return reflect.TypeOf((**Workitemquery)(nil)).Elem()
}

func (o WorkitemqueryOutput) ToWorkitemqueryOutput() WorkitemqueryOutput {
	return o
}

func (o WorkitemqueryOutput) ToWorkitemqueryOutputWithContext(ctx context.Context) WorkitemqueryOutput {
	return o
}

// Root folder for the query. Must be one of `Shared Queries` or `My Queries`.
func (o WorkitemqueryOutput) Area() pulumi.StringPtrOutput {
	return o.ApplyT(func(v *Workitemquery) pulumi.StringPtrOutput { return v.Area }).(pulumi.StringPtrOutput)
}

// The display name of the query.
func (o WorkitemqueryOutput) Name() pulumi.StringOutput {
	return o.ApplyT(func(v *Workitemquery) pulumi.StringOutput { return v.Name }).(pulumi.StringOutput)
}

// The ID of the parent query folder under which to create the query.
func (o WorkitemqueryOutput) ParentId() pulumi.StringPtrOutput {
	return o.ApplyT(func(v *Workitemquery) pulumi.StringPtrOutput { return v.ParentId }).(pulumi.StringPtrOutput)
}

// The ID of the Project containing the query.
func (o WorkitemqueryOutput) ProjectId() pulumi.StringOutput {
	return o.ApplyT(func(v *Workitemquery) pulumi.StringOutput { return v.ProjectId }).(pulumi.StringOutput)
}

// The WIQL (Work Item Query Language) statement. Length 1–32000 characters.
func (o WorkitemqueryOutput) Wiql() pulumi.StringOutput {
	return o.ApplyT(func(v *Workitemquery) pulumi.StringOutput { return v.Wiql }).(pulumi.StringOutput)
}

type WorkitemqueryArrayOutput struct{ *pulumi.OutputState }

func (WorkitemqueryArrayOutput) ElementType() reflect.Type {
	return reflect.TypeOf((*[]*Workitemquery)(nil)).Elem()
}

func (o WorkitemqueryArrayOutput) ToWorkitemqueryArrayOutput() WorkitemqueryArrayOutput {
	return o
}

func (o WorkitemqueryArrayOutput) ToWorkitemqueryArrayOutputWithContext(ctx context.Context) WorkitemqueryArrayOutput {
	return o
}

func (o WorkitemqueryArrayOutput) Index(i pulumi.IntInput) WorkitemqueryOutput {
	return pulumi.All(o, i).ApplyT(func(vs []interface{}) *Workitemquery {
		return vs[0].([]*Workitemquery)[vs[1].(int)]
	}).(WorkitemqueryOutput)
}

type WorkitemqueryMapOutput struct{ *pulumi.OutputState }

func (WorkitemqueryMapOutput) ElementType() reflect.Type {
	return reflect.TypeOf((*map[string]*Workitemquery)(nil)).Elem()
}

func (o WorkitemqueryMapOutput) ToWorkitemqueryMapOutput() WorkitemqueryMapOutput {
	return o
}

func (o WorkitemqueryMapOutput) ToWorkitemqueryMapOutputWithContext(ctx context.Context) WorkitemqueryMapOutput {
	return o
}

func (o WorkitemqueryMapOutput) MapIndex(k pulumi.StringInput) WorkitemqueryOutput {
	return pulumi.All(o, k).ApplyT(func(vs []interface{}) *Workitemquery {
		return vs[0].(map[string]*Workitemquery)[vs[1].(string)]
	}).(WorkitemqueryOutput)
}

func init() {
	pulumi.RegisterInputType(reflect.TypeOf((*WorkitemqueryInput)(nil)).Elem(), &Workitemquery{})
	pulumi.RegisterInputType(reflect.TypeOf((*WorkitemqueryArrayInput)(nil)).Elem(), WorkitemqueryArray{})
	pulumi.RegisterInputType(reflect.TypeOf((*WorkitemqueryMapInput)(nil)).Elem(), WorkitemqueryMap{})
	pulumi.RegisterOutputType(WorkitemqueryOutput{})
	pulumi.RegisterOutputType(WorkitemqueryArrayOutput{})
	pulumi.RegisterOutputType(WorkitemqueryMapOutput{})
}
